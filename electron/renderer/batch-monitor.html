<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Batch Monitor - Lasercomb Studio</title>
    <link rel="stylesheet" href="batch-monitor.css">
    <style>
        /* Ensure recent results text is visible in dark mode */
        @media (prefers-color-scheme: dark) {
            .recentResults .file-item,
            #recentResults .file-item,
            .file-item .file-name,
            .file-item .file-status {
                color: #e5e7eb !important;
            }
            .file-status.error {
                background: #fee2e2;
                color: #ef4444 !important;
            }
            .file-status.completed {
                background: #d1fae5;
                color: #10b981 !important;
            }
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f7;
            color: #1d1d1f;
            overflow: hidden;
        }

        .monitor-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .header-bar {
            background: #ffffff;
            border-bottom: 1px solid #d2d2d7;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
            color: #1d1d1f;
        }

        .header-controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-indicator.active {
            background: #d1f2eb;
            color: #047857;
        }

        .status-indicator.inactive {
            background: #fee2e2;
            color: #dc2626;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-indicator.active .status-dot {
            background: #10b981;
        }

        .status-indicator.inactive .status-dot {
            background: #ef4444;
        }

        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .left-panel, .right-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            margin: 8px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .left-panel {
            margin-right: 4px;
        }

        .right-panel {
            margin-left: 4px;
        }

        .panel-header {
            padding: 16px 20px;
            border-bottom: 1px solid #f0f0f0;
            background: #fafafa;
            border-radius: 8px 8px 0 0;
        }

        .panel-title {
            font-size: 16px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 8px;
        }

        .panel-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .folder-selection {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .folder-input-group {
            display: flex;
            gap: 8px;
        }

        .folder-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #007aff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #1e7e34;
        }

        .monitoring-controls {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        .file-queue {
            margin-top: 20px;
        }

        .queue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .queue-title {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
        }

        .queue-count {
            background: #e5e7eb;
            color: #374151;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .file-list {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            max-height: 200px;
            overflow-y: auto;
        }

        .file-item {
            padding: 8px 12px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-name {
            font-weight: 500;
            color: #1f2937;
        }

        .file-status {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 500;
        }

        .file-status.pending {
            background: #fef3c7;
            color: #92400e;
        }

        .file-status.processing {
            background: #dbeafe;
            color: #1e40af;
        }

        .file-status.completed {
            background: #d1fae5;
            color: #065f46;
        }

        .file-status.error {
            background: #fee2e2;
            color: #991b1b;
        }

        .log-panel {
            margin-top: 20px;
        }

        .log-content {
            background: #1f2937;
            color: #f3f4f6;
            border-radius: 6px;
            padding: 12px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 12px;
            line-height: 1.4;
            height: 200px;
            overflow-y: auto;
        }

        .log-entry {
            margin-bottom: 4px;
        }

        .log-timestamp {
            color: #9ca3af;
        }

        .log-level-info {
            color: #60a5fa;
        }

        .log-level-success {
            color: #34d399;
        }

        .log-level-warning {
            color: #fbbf24;
        }

        .log-level-error {
            color: #f87171;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 16px;
            margin-bottom: 8px;
        }

        .empty-state-subtext {
            font-size: 14px;
            color: #9ca3af;
        }
        /* Dark theme support */
        @media (prefers-color-scheme: dark) {
            body {
                background: #18181b;
                color: #e5e7eb;
            }
            .monitor-container {
                background: #18181b;
            }
            .header-bar {
                background: #23232a;
                border-bottom: 1px solid #23232a;
                color: #e5e7eb;
                box-shadow: 0 1px 3px rgba(0,0,0,0.4);
            }
            .left-panel, .right-panel {
                background: #23232a;
                box-shadow: 0 1px 3px rgba(0,0,0,0.5);
            }
            .panel-header {
                background: #23232a;
                border-bottom: 1px solid #23232a;
                color: #e5e7eb;
            }
            .panel-title {
                color: #e5e7eb;
            }
            .panel-content {
                background: #18181b;
                color: #e5e7eb;
            }
            .folder-input {
                background: #23232a;
                color: #e5e7eb;
                border: 1px solid #333646;
            }
            .btn {
                background: #23232a;
                color: #e5e7eb;
                border: 1px solid #333646;
            }
            .btn-primary {
                background: #2563eb;
                color: #fff;
                border: 1px solid #1e40af;
            }
            .btn-primary:hover {
                background: #1e40af;
            }
            .btn-secondary {
                background: #374151;
                color: #e5e7eb;
                border: 1px solid #4b5563;
            }
            .btn-secondary:hover {
                background: #4b5563;
            }
            .btn-success {
                background: #059669;
                color: #fff;
                border: 1px solid #047857;
            }
            .btn-success:hover {
                background: #047857;
            }
            .file-list {
                background: #23232a;
                border: 1px solid #333646;
            }
            .file-item {
                border-bottom: 1px solid #333646;
                color: #e5e7eb;
            }
            .log-content {
                background: #18181b;
                color: #e5e7eb;
                border: 1px solid #333646;
            }
            .empty-state {
                color: #6b7280;
            }
            .queue-count {
                background: #23232a;
                color: #e5e7eb;
                border: 1px solid #333646;
            }
        }
    </style>
</head>
<body>
    <div class="monitor-container">
        <!-- Header Bar -->
        <div class="header-bar">
                            <div class="header-title">🔍 File Batch Monitor</div>
            <div class="header-controls">
                <div class="status-indicator inactive" id="monitoringStatus">
                    <div class="status-dot"></div>
                    <span>Monitoring Inactive</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Panel: Input Monitoring -->
            <div class="left-panel">
                <div class="panel-header">
                    <div class="panel-title">📁 Input Folder Monitoring</div>
                    <div style="font-size: 13px; color: #6b7280;">Watch for new files (DXF, DDS, CF2)</div>
                </div>
                <div class="panel-content">
                    <!-- Folder Selection -->
                    <div class="folder-selection">
                        <label for="inputFolder" style="font-size: 14px; font-weight: 500; color: #374151;">Input Folder Path:</label>
                        <div class="folder-input-group">
                            <input type="text" id="inputFolder" class="folder-input" placeholder="Select or enter folder path..." />
                            <button class="btn btn-secondary" id="browseInputBtn">Browse</button>
                        </div>
                        
                        <!-- Monitoring Controls -->
                        <div class="monitoring-controls">
                            <button class="btn btn-success" id="startMonitoringBtn">🟢 Start Monitoring</button>
                            <button class="btn btn-secondary" id="stopMonitoringBtn" disabled>🔴 Stop Monitoring</button>
                            <button class="btn btn-primary" id="manualScanBtn">🔄 Manual Scan</button>
                        </div>
                    </div>

                    <!-- File Queue -->
                    <div class="file-queue">
                        <div class="queue-header">
                            <div class="queue-title">Processing Queue</div>
                            <div class="queue-count" id="queueCount">0 files</div>
                        </div>
                        <div class="file-list" id="fileQueue">
                            <div class="empty-state">
                                <div class="empty-state-icon">📄</div>
                                <div class="empty-state-text">No files in queue</div>
                                <div class="empty-state-subtext">Supported files (DXF, DDS, CF2) will appear here when detected</div>
                            </div>
                        </div>
                    </div>

                    <!-- Processing Log -->
                    <div class="log-panel">
                        <div class="queue-header" style="gap: 8px; align-items: flex-end;">
                            <div class="queue-title">Processing Log</div>
                            <input type="text" id="processingLogSearch" class="folder-input" placeholder="Search log..." style="max-width: 160px; font-size: 12px; padding: 4px 8px;" />
                            <select id="processingLogFilter" class="folder-input" style="max-width: 110px; font-size: 12px; padding: 4px 8px;">
                                <option value="all">All</option>
                                <option value="info">Info</option>
                                <option value="success">Success</option>
                                <option value="warning">Warning</option>
                                <option value="error">Error</option>
                            </select>
                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" id="exportProcessingLogBtn">Export</button>
                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" id="clearLogBtn">Clear</button>
                        </div>
                        <div class="log-content" id="processingLog">
                            <div class="log-entry">
                                <span class="log-timestamp">[00:00:00]</span>
                                <span class="log-level-info">[INFO]</span>
                                <span>Batch monitor initialized</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Output Management -->
            <div class="right-panel">
                <div class="panel-header">
                    <div class="panel-title">📤 Output Folder Management</div>
                    <div style="font-size: 13px; color: #6b7280;">Generated DIN files destination</div>
                </div>
                <div class="panel-content">
                    <!-- Output Folder Selection -->
                    <div class="folder-selection">
                        <label for="outputFolder" style="font-size: 14px; font-weight: 500; color: #374151;">Output Folder Path:</label>
                        <div class="folder-input-group">
                            <input type="text" id="outputFolder" class="folder-input" placeholder="Select or enter output folder path..." />
                            <button class="btn btn-secondary" id="browseOutputBtn">Browse</button>
                        </div>
                    </div>

                    <!-- Processing Statistics -->
                    <div style="margin-top: 20px;">
                        <div class="queue-title" style="margin-bottom: 12px;">📊 Session Statistics</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <div style="background: #f3f4f6; padding: 12px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 600; color: #059669;" id="successCount">0</div>
                                <div style="font-size: 12px; color: #6b7280;">Successful</div>
                            </div>
                            <div style="background: #f3f4f6; padding: 12px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 600; color: #dc2626;" id="errorCount">0</div>
                                <div style="font-size: 12px; color: #6b7280;">Failed</div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Results -->
                    <div style="margin-top: 20px;">
                        <div class="queue-header">
                            <div class="queue-title">Recent Results</div>
                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" id="clearResultsBtn">Clear</button>
                        </div>
                        <div class="file-list" id="recentResults">
                            <div class="empty-state">
                                <div class="empty-state-icon">✅</div>
                                <div class="empty-state-text">No processing results yet</div>
                                <div class="empty-state-subtext">Completed operations will appear here</div>
                            </div>
                        </div>
                    </div>

                    <!-- Output Log -->
                    <div class="log-panel">
                        <div class="queue-header" style="gap: 8px; align-items: flex-end;">
                            <div class="queue-title">Output Log</div>
                            <input type="text" id="outputLogSearch" class="folder-input" placeholder="Search log..." style="max-width: 160px; font-size: 12px; padding: 4px 8px;" />
                            <select id="outputLogFilter" class="folder-input" style="max-width: 110px; font-size: 12px; padding: 4px 8px;">
                                <option value="all">All</option>
                                <option value="info">Info</option>
                                <option value="success">Success</option>
                                <option value="warning">Warning</option>
                                <option value="error">Error</option>
                            </select>
                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" id="exportOutputLogBtn">Export</button>
                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;" id="clearOutputLogBtn">Clear</button>
                        </div>
                        <div class="log-content" id="outputLog">
                            <div class="log-entry">
                                <span class="log-timestamp">[00:00:00]</span>
                                <span class="log-level-info">[INFO]</span>
                                <span>Output monitor ready</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="batch-monitor.js"></script>
</body>
</html>
